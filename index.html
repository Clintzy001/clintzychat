<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ClintzyApp | Pulse Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root { 
            --brand: #F57C00; 
            --bg-primary: #000000;
            --bg-secondary: #121212;
            --text-main: #ffffff;
            --text-dim: #71717a;
            --glass: rgba(255, 255, 255, 0.03);
            --border-glass: rgba(255, 255, 255, 0.05);
            --safe-area-inset-bottom: env(safe-area-inset-bottom);
        }

        .hidden { display: none; }
        * { -webkit-tap-highlight-color: transparent; scrollbar-width: none; transition: background-color 0.3s ease, color 0.3s ease; }
        ::-webkit-scrollbar { display: none; }

        body { background-color: var(--bg-primary); color: var(--text-main); font-family: 'Inter', sans-serif; }

        /* Splash Screen */
        #splash-screen {
            position: fixed; inset: 0; background: black; display: flex;
            flex-direction: column; align-items: center; justify-content: center;
            z-index: 9999; transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
        }

        /* PROFILE GLOW ANIMATION */
        .profile-glow {
            position: relative; padding: 3px; border-radius: 2rem;
            background: linear-gradient(45deg, #F57C00, #ff00ea, #00d4ff, #F57C00);
            background-size: 300% 300%; animation: flowGradient 4s ease infinite;
        }

        @keyframes flowGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .wave-card {
            background: linear-gradient(180deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.01) 100%);
            border: 1px solid rgba(255,255,255,0.08);
        }

        /* Profile Specific Styles */
        .profile-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .follow-btn {
            background: linear-gradient(45deg, var(--brand), #ffcc00);
            box-shadow: 0 4px 15px rgba(245, 124, 0, 0.3);
        }

        .content-tab-active {
            color: var(--brand);
            border-bottom: 2px solid var(--brand);
        }

        .media-grid-item {
            aspect-ratio: 1 / 1;
            border-radius: 1.5rem;
            overflow: hidden;
            background: #18181b;
            position: relative;
        }

        .nav-active { color: var(--brand) !important; position: relative; }
        .nav-active::after {
            content: ''; position: absolute; bottom: -8px; width: 4px; height: 4px;
            background: var(--brand); border-radius: 50%;
        }

        .fade-in-section { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .verification-dot { width: 8px; height: 8px; border-radius: 50%; background: #22c55e; box-shadow: 0 0 10px #22c55e; }
        #more-menu { transform-origin: top right; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); }
        
        /* Message Bubbles */
        .msg-in { background: #18181b; border-radius: 1.5rem 1.5rem 1.5rem 0.2rem; }
        .msg-out { background: var(--brand); color: black; border-radius: 1.5rem 1.5rem 0.2rem 1.5rem; }
    </style>
</head>
<body class="overflow-hidden">

    <div id="splash-screen">
        <h1 class="text-5xl font-black italic tracking-tighter text-[#F57C00] animate-pulse">Clintzy</h1>
        <div class="absolute bottom-12 flex flex-col items-center">
            <div class="flex gap-1 mb-4">
                <div class="w-1.5 h-1.5 bg-[#F57C00] rounded-full animate-bounce"></div>
                <div class="w-1.5 h-1.5 bg-[#F57C00] rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                <div class="w-1.5 h-1.5 bg-[#F57C00] rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
            </div>
            <p class="text-zinc-500 text-[10px] uppercase tracking-[0.4em]">Pulse Pro Engine</p>
        </div>
    </div>

    <div id="app-content" class="h-screen flex flex-col opacity-0 transition-opacity duration-700">
        <header class="px-6 py-5 flex justify-between items-center bg-transparent backdrop-blur-md sticky top-0 z-50">
            <div class="flex flex-col">
                <div class="flex items-center gap-2">
                    <h1 class="text-2xl font-black italic tracking-tighter text-[#F57C00]">Clintzy</h1>
                    <div class="verification-dot"></div>
                </div>
                <p class="text-[8px] font-black uppercase tracking-[0.2em] text-zinc-600 leading-none mt-1">from Clintzy Tech</p>
            </div>
            <div class="flex items-center space-x-6">
                <button onclick="switchTab('vault')" class="relative"><i data-lucide="bookmark" class="w-6 h-6 text-zinc-400 hover:text-[#F57C00]"></i></button>
                <button onclick="toggleMenu()"><i data-lucide="menu" class="w-6 h-6 text-zinc-400"></i></button>
            </div>

            <div id="more-menu" class="hidden absolute top-16 right-6 w-56 bg-[#121212] border border-white/5 rounded-3xl shadow-2xl z-[100] overflow-hidden p-2">
                <button onclick="switchTab('settings')" class="w-full p-4 text-left text-sm font-bold hover:bg-white/5 rounded-2xl">Pulse Settings</button>
                <div class="h-[1px] bg-white/5 my-2"></div>
                <button onclick="initiateSignOut()" class="w-full p-4 text-left text-sm font-bold text-red-500 hover:bg-red-500/10 rounded-2xl">Sign Out</button>
            </div>
        </header>

        <main class="flex-1 overflow-y-auto">
            <div id="home-section" class="fade-in-section">
                <div class="px-6 mb-8 mt-4">
                    <div class="bg-zinc-900/50 border border-white/5 rounded-[2rem] px-5 py-4 flex items-center gap-4 group focus-within:border-[#F57C00]/50 transition-all">
                        <i data-lucide="sparkles" class="w-5 h-5 text-[#F57C00]"></i>
                        <input type="text" placeholder="Ask Clintzy AI..." class="bg-transparent outline-none w-full text-sm font-medium placeholder-zinc-600">
                    </div>
                </div>

                <div class="mb-10">
                    <div class="px-6 flex justify-between items-center mb-4">
                        <h3 class="text-xs font-black uppercase tracking-widest text-zinc-500">Live Pulse</h3>
                    </div>
                    <div class="flex gap-5 overflow-x-auto px-6 pb-2 no-scrollbar">
                        <div class="flex flex-col items-center gap-2">
                            <div class="w-16 h-16 rounded-[1.8rem] bg-zinc-900 border-2 border-dashed border-zinc-700 flex items-center justify-center cursor-pointer" onclick="togglePulseCreator()">
                                <i data-lucide="plus" class="w-5 h-5 text-zinc-500"></i>
                            </div>
                            <span class="text-[9px] font-bold opacity-40 uppercase">YOU</span>
                        </div>
                        <script>
                            const users = [
                                {n: 'JESSICA', img: 'jessica'}, {n: 'MARCUS', img: 'marcus'}, 
                                {n: 'ALEX', img: 'alex'}, {n: 'SARAH', img: 'sarah'}, 
                                {n: 'KAI', img: 'kai'}, {n: 'ZANE', img: 'zane'}
                            ];
                            document.write(users.map(u => `
                                <div class="flex flex-col items-center gap-2 cursor-pointer group">
                                    <div class="profile-glow">
                                        <div class="w-14 h-14 rounded-[1.6rem] overflow-hidden bg-black">
                                            <img src="https://i.pravatar.cc/150?u=${u.img}" class="w-full h-full object-cover">
                                        </div>
                                    </div>
                                    <span class="text-[9px] font-black group-hover:text-[#F57C00] tracking-tighter">${u.n}</span>
                                </div>
                            `).join(''));
                        </script>
                    </div>
                </div>

                <div class="px-6 pb-32 space-y-6" id="waves-feed">
                    <h3 class="text-xs font-black uppercase tracking-widest text-zinc-500 mb-2">Public Waves</h3>
                    <div class="wave-card p-5 rounded-[2.5rem]">
                        <div class="flex items-center gap-3 mb-4">
                            <img src="https://i.pravatar.cc/150?u=kai" class="w-8 h-8 rounded-full border border-white/10">
                            <span class="text-xs font-black">KAI.DEV</span>
                            <span class="text-[10px] text-zinc-600">3m</span>
                        </div>
                        <div class="bg-black/50 p-4 rounded-2xl mb-4 font-mono text-[11px] text-[#F57C00] border border-[#F57C00]/20">
                            console.log("Hello Pulse!");
                        </div>
                        <div class="flex justify-between items-center text-zinc-400">
                            <div class="flex gap-4">
                                <button class="flex items-center gap-1.5 hover:text-red-500"><i data-lucide="heart" class="w-4 h-4"></i><span class="text-[10px]">24</span></button>
                                <button class="flex items-center gap-1.5 hover:text-[#F57C00]"><i data-lucide="message-square" class="w-4 h-4"></i><span class="text-[10px]">8</span></button>
                            </div>
                            <div class="flex gap-4">
                                <i data-lucide="bookmark" class="w-4 h-4 hover:text-white"></i>
                                <i data-lucide="send" class="w-4 h-4 hover:text-white"></i>
                            </div>
                        </div>
                    </div>
                    </div>
            </div>

            <section id="chat-page" class="hidden px-6 pt-4 pb-32">
                <h2 class="text-2xl font-black uppercase italic mb-6">Pulse Chat</h2>
                <div class="space-y-4" id="active-chats"></div>
            </section>

            <section id="group-page" class="hidden px-6 pt-4 pb-32">
                <div class="mb-8">
                    <h2 class="text-2xl font-black uppercase italic">Pulse Groups</h2>
                    <p class="text-[10px] text-zinc-500 font-black tracking-widest uppercase">Connect to private waves</p>
                </div>
                <div class="bg-zinc-900/40 border border-white/5 rounded-[2.5rem] p-8 mb-6 text-center">
                    <div class="w-16 h-16 bg-[#F57C00]/10 rounded-3xl flex items-center justify-center mx-auto mb-6">
                        <i data-lucide="hash" class="w-8 h-8 text-[#F57C00]"></i>
                    </div>
                    <h3 class="font-black text-lg mb-2 uppercase italic">Join a Group</h3>
                    <div class="flex gap-2 justify-center mb-8">
                        <input type="text" maxlength="6" placeholder="000000" class="w-full max-w-[200px] bg-black border border-white/10 rounded-2xl py-4 text-center text-2xl font-black tracking-[0.5em] text-[#F57C00] outline-none focus:border-[#F57C00]">
                    </div>
                    <button onclick="joinPulseGroup()" class="w-full bg-white text-black font-black py-4 rounded-2xl uppercase active:scale-95 transition-transform">Verify Code</button>
                </div>
            </section>

            <section id="vault-page" class="hidden px-6 pt-4 pb-32">
                <div class="flex justify-between items-end mb-8">
                    <div>
                        <h2 class="text-2xl font-black uppercase italic leading-none">The Vault</h2>
                        <p class="text-[10px] text-zinc-500 font-bold uppercase mt-2 tracking-widest">Biometric Encrypted</p>
                    </div>
                    <div class="text-right">
                        <p class="text-[10px] font-black text-[#F57C00] mb-1">72% FULL</p>
                        <div class="w-24 h-1.5 bg-zinc-900 rounded-full overflow-hidden border border-white/5"><div class="h-full bg-[#F57C00] w-[72%]"></div></div>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4 mb-8">
                    <div class="bg-zinc-900/40 p-5 rounded-[2rem] border border-white/5"><i data-lucide="image" class="w-5 h-5 text-blue-500 mb-4"></i><h4 class="text-xs font-black uppercase">Waves</h4></div>
                    <div class="bg-zinc-900/40 p-5 rounded-[2rem] border border-white/5"><i data-lucide="mic" class="w-5 h-5 text-purple-500 mb-4"></i><h4 class="text-xs font-black uppercase">Voice Notes</h4></div>
                </div>
            </section>

            <section id="profile-page" class="hidden pt-4 pb-32">
                <div class="px-6 text-center">
                    <div class="profile-glow w-28 h-28 mx-auto mb-4">
                        <div class="w-full h-full rounded-[2rem] overflow-hidden bg-black border-2 border-black">
                            <img src="https://i.pravatar.cc/150?u=me" class="w-full h-full object-cover">
                        </div>
                    </div>
                    
                    <h2 class="text-2xl font-black italic mb-1">Clintzy Creator</h2>
                    <p class="text-[10px] text-zinc-500 uppercase font-black tracking-[0.2em] mb-6">Digital Architect ‚Ä¢ Pulse Pro</p>

                    <div class="flex justify-around items-center mb-6 bg-zinc-900/30 py-4 rounded-3xl border border-white/5">
                        <div class="profile-stat">
                            <span class="text-lg font-black italic">12.4K</span>
                            <span class="text-[9px] text-zinc-500 font-bold uppercase">Followers</span>
                        </div>
                        <div class="h-8 w-[1px] bg-white/10"></div>
                        <button class="follow-btn px-8 py-2.5 rounded-2xl text-black text-xs font-black uppercase tracking-tighter active:scale-90 transition-all">
                            Follow
                        </button>
                        <div class="h-8 w-[1px] bg-white/10"></div>
                        <div class="profile-stat">
                            <span class="text-lg font-black italic">842</span>
                            <span class="text-[9px] text-zinc-500 font-bold uppercase">Following</span>
                        </div>
                    </div>

                    <div class="text-left bg-zinc-900/20 p-6 rounded-[2.5rem] border border-white/5 mb-8">
                        <h4 class="text-[10px] font-black text-[#F57C00] uppercase mb-2 tracking-widest">Public Bio</h4>
                        <p class="text-sm text-zinc-300 leading-relaxed mb-4">
                            Building the future of decentralized social waves. Obsessed with clean UI and high-performance scripts. üçä
                        </p>
                        
                        <div class="grid grid-cols-2 gap-y-3">
                            <div class="flex items-center gap-2">
                                <i data-lucide="heart" class="w-3.5 h-3.5 text-zinc-500"></i>
                                <span class="text-[10px] font-bold text-zinc-400">Marital: <span class="text-white">Single</span></span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i data-lucide="map-pin" class="w-3.5 h-3.5 text-zinc-500"></i>
                                <span class="text-[10px] font-bold text-zinc-400">Base: <span class="text-white">Lagos</span></span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i data-lucide="smile" class="w-3.5 h-3.5 text-zinc-500"></i>
                                <span class="text-[10px] font-bold text-zinc-400">Hobbies: <span class="text-white">Chess, Coding</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex border-b border-white/5 px-6 mb-4">
                    <button onclick="filterProfile('all')" class="flex-1 py-3 text-[10px] font-black uppercase tracking-widest content-tab-active">All Waves</button>
                    <button onclick="filterProfile('media')" class="flex-1 py-3 text-[10px] font-black uppercase tracking-widest text-zinc-500">Media</button>
                    <button onclick="filterProfile('audio')" class="flex-1 py-3 text-[10px] font-black uppercase tracking-widest text-zinc-500">Audio</button>
                </div>

                <div class="px-6 grid grid-cols-3 gap-3" id="profile-media-grid">
                    <div class="media-grid-item">
                        <img src="https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=200" class="w-full h-full object-cover">
                    </div>
                    <div class="media-grid-item flex items-center justify-center bg-zinc-900 border border-white/5">
                        <i data-lucide="play" class="w-6 h-6 text-white/20"></i>
                        <img src="https://images.unsplash.com/photo-1611162617474-5b21e879e113?w=200" class="absolute inset-0 w-full h-full object-cover opacity-50">
                    </div>
                    <div class="media-grid-item flex flex-col items-center justify-center bg-[#F57C00]/10 border border-[#F57C00]/20">
                        <i data-lucide="mic" class="w-6 h-6 text-[#F57C00] mb-1"></i>
                        <span class="text-[8px] font-black text-[#F57C00]">VOICE_01</span>
                    </div>
                    <div class="media-grid-item"><img src="https://images.unsplash.com/photo-1531297484001-80022131f5a1?w=200" class="w-full h-full object-cover"></div>
                    <div class="media-grid-item"><img src="https://images.unsplash.com/photo-1498050108023-c5249f4df085?w=200" class="w-full h-full object-cover"></div>
                    <div class="media-grid-item bg-zinc-900 flex items-center justify-center"><i data-lucide="music" class="w-6 h-6 text-zinc-700"></i></div>
                </div>
            </section>
        </main>

        <nav class="fixed bottom-0 inset-x-0 bg-black/80 backdrop-blur-2xl border-t border-white/5 px-8 pt-4 pb-10 flex justify-between items-center z-50">
            <button onclick="switchTab('wave')" class="nav-item nav-active flex flex-col items-center gap-1">
                <i data-lucide="layout-grid" class="w-6 h-6"></i>
                <span class="text-[9px] font-black uppercase">Wave</span>
            </button>
            <button onclick="switchTab('chat')" class="nav-item flex flex-col items-center gap-1 text-zinc-500">
                <i data-lucide="message-circle" class="w-6 h-6"></i>
                <span class="text-[9px] font-black uppercase">Chat</span>
            </button>
            <div class="absolute left-1/2 -translate-x-1/2 -top-6">
                <button onclick="togglePulseCreator()" class="w-16 h-16 bg-[#F57C00] rounded-[2rem] flex items-center justify-center active:scale-90 transition-all">
                    <i data-lucide="zap" class="w-8 h-8 text-black fill-black"></i>
                </button>
            </div>
            <button onclick="switchTab('group')" class="nav-item flex flex-col items-center gap-1 text-zinc-500">
                <i data-lucide="users" class="w-6 h-6"></i>
                <span class="text-[9px] font-black uppercase">Groups</span>
            </button>
            <button onclick="switchTab('profile')" class="nav-item flex flex-col items-center gap-1 text-zinc-500">
                <i data-lucide="user" class="w-6 h-6"></i>
                <span class="text-[9px] font-black uppercase">Me</span>
            </button>
        </nav>
    </div>

    <div id="convo-overlay" class="hidden fixed inset-0 bg-black z-[700] flex flex-col transition-all duration-300 translate-y-full">
        <header class="p-6 flex items-center gap-4 border-b border-white/5 bg-black/50 backdrop-blur-xl">
            <button onclick="closeConvo()"><i data-lucide="chevron-left" class="w-6 h-6"></i></button>
            <img id="convo-avatar" src="" class="w-10 h-10 rounded-2xl">
            <h3 id="convo-name" class="font-black italic">Name</h3>
        </header>
        <div id="convo-messages" class="flex-1 overflow-y-auto p-6 space-y-4">
            <div class="msg-in p-4 max-w-[80%] text-sm">Hey! I saw your latest Wave. Pulse looks stable.</div>
            <div class="msg-out p-4 max-w-[80%] ml-auto text-sm">Thanks! Just finished the Pro build.</div>
        </div>
        <div class="p-6 bg-black border-t border-white/5 pb-12">
            <div class="flex gap-4 items-center bg-zinc-900 rounded-2xl p-2 px-4">
                <input type="text" placeholder="Pulse message..." class="flex-1 bg-transparent py-2 outline-none text-sm">
                <button class="text-[#F57C00]"><i data-lucide="send" class="w-5 h-5"></i></button>
            </div>
        </div>
    </div>

    <div id="pulse-creator" class="hidden fixed inset-0 bg-black z-[600] flex flex-col">
        <div class="p-6 flex justify-between items-center z-10">
            <button onclick="togglePulseCreator()"><i data-lucide="x" class="w-8 h-8 text-white"></i></button>
            <h2 class="text-sm font-black italic tracking-widest text-[#F57C00]">NEW WAVE</h2>
            <button onclick="flipCamera()"><i data-lucide="refresh-cw" class="w-6 h-6 text-white"></i></button>
        </div>
        <div class="flex-1 relative bg-zinc-900"><video id="viewfinder" autoplay playsinline class="w-full h-full object-cover"></video></div>
        <div class="p-8 bg-black">
            <button onclick="togglePulseCreator()" class="w-full bg-[#F57C00] text-black font-black py-4 rounded-2xl uppercase">Publish Wave</button>
        </div>
    </div>

    <script>
        let currentStream = null;
        let useFrontCamera = true;
        let chats = [
            { id: 1, name: 'Jessica Griffin', message: 'Active now', avatar: 'https://i.pravatar.cc/150?u=jessica' },
            { id: 2, name: 'Boss Clintzy', message: 'Pulse Pro is live! üçä', avatar: 'https://i.pravatar.cc/150?u=clint' }
        ];

        window.addEventListener('load', () => {
            // Simulated authorization check (kept from your structure)
            if (localStorage.getItem('pulse_authorized') === 'false') window.location.href = "auth.html";
            else finalizeAuth();
            
            setTimeout(() => {
                document.getElementById('splash-screen').style.opacity = '0';
                setTimeout(() => document.getElementById('splash-screen').style.visibility = 'hidden', 500);
            }, 2500);
        });

        function finalizeAuth() {
            document.getElementById('app-content').style.opacity = '1';
            renderChats();
        }

        // Integrated switchTab
        function switchTab(tab) {
            const ids = ['home-section', 'chat-page', 'vault-page', 'group-page', 'profile-page'];
            ids.forEach(id => {
                const el = document.getElementById(id);
                if(el) el.classList.add('hidden');
            });

            const targetId = (tab === 'wave') ? 'home-section' : `${tab}-page`;
            const targetEl = document.getElementById(targetId);
            if(targetEl) targetEl.classList.remove('hidden');
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('nav-active', 'text-white');
                item.classList.add('text-zinc-500');
                if(item.innerText.toLowerCase().includes(tab) || (tab === 'profile' && item.innerText.includes('Me'))) {
                    item.classList.add('nav-active');
                    item.classList.remove('text-zinc-500');
                }
            });
            lucide.createIcons();
        }

        // Profile Filter Logic
        function filterProfile(type) {
            const buttons = document.querySelectorAll('#profile-page button');
            buttons.forEach(btn => {
                if(btn.innerText.toLowerCase().includes(type) || (type === 'all' && btn.innerText.includes('ALL'))) {
                    btn.classList.add('content-tab-active');
                    btn.classList.remove('text-zinc-500');
                } else if (btn.classList.contains('py-3')) {
                    btn.classList.remove('content-tab-active');
                    btn.classList.add('text-zinc-500');
                }
            });

            console.log(`Filtering profile by: ${type}`);
            // In a real app, grid logic would go here
            lucide.createIcons();
        }

        function renderChats() {
            const container = document.getElementById('active-chats');
            if(!container) return;
            container.innerHTML = chats.map(chat => `
                <div onclick="openConvo('${chat.name}', '${chat.avatar}')" class="flex items-center gap-4 bg-zinc-900/40 p-4 rounded-3xl border border-white/5 active:scale-95 transition-all cursor-pointer">
                    <img src="${chat.avatar}" class="w-12 h-12 rounded-2xl object-cover">
                    <div class="flex-1">
                        <h4 class="font-bold text-sm text-white">${chat.name}</h4>
                        <p class="text-[10px] text-[#F57C00] font-bold">${chat.message}</p>
                    </div>
                    <i data-lucide="chevron-right" class="w-4 h-4 text-zinc-600"></i>
                </div>
            `).join('');
            lucide.createIcons();
        }

        function openConvo(name, avatar) {
            const overlay = document.getElementById('convo-overlay');
            document.getElementById('convo-name').innerText = name;
            document.getElementById('convo-avatar').src = avatar;
            overlay.classList.remove('hidden');
            setTimeout(() => overlay.style.transform = "translateY(0)", 10);
            lucide.createIcons();
        }

        function closeConvo() {
            const overlay = document.getElementById('convo-overlay');
            overlay.style.transform = "translateY(100%)";
            setTimeout(() => overlay.classList.add('hidden'), 300);
        }

        async function togglePulseCreator() {
            const creator = document.getElementById('pulse-creator');
            const isOpening = creator.classList.contains('hidden');
            creator.classList.toggle('hidden');
            if (isOpening) {
                try {
                    currentStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: useFrontCamera ? "user" : "environment" } });
                    document.getElementById('viewfinder').srcObject = currentStream;
                } catch(e) { console.error("Camera access denied"); }
            } else if (currentStream) {
                currentStream.getTracks().forEach(track => track.stop());
            }
        }

        function toggleMenu() { document.getElementById('more-menu').classList.toggle('hidden'); }
        function joinPulseGroup() { alert("Verified! Group joined."); }
        function initiateSignOut() { localStorage.removeItem('pulse_authorized'); window.location.reload(); }

        lucide.createIcons();
    </script>
</body>
</html>
